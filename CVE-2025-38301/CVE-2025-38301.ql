import cpp

from Function f, VariableAccess configAccess
where
  // 定位到目标函数
  f.getName() = "zynqmp_nvmem_probe" and
  f.getFile().getBaseName() = "zynqmp_nvmem.c" and
  
  // 在函数中查找对econfig的访问
  configAccess.getTarget().getName() = "econfig" and
  configAccess.getEnclosingFunction() = f and
  
  // 确保没有对priv字段的赋值
  not exists(FieldAccess privAccess |
    privAccess.getQualifier() = configAccess and
    privAccess.getTarget().getName() = "priv" and
    privAccess.getEnclosingFunction() = f
  )
select configAccess