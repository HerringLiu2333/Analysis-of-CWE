import cpp

from GlobalVariable gv, Expr elem, ClassAggregateLiteral aggr, Field field, Expr value
where gv.getFile().getBaseName() = "seg6_local.c" and
      // 暂时定位在对应文件内

      gv.getName() = "seg6_local_policy" and
      (elem = gv.getInitializer().getExpr().(ArrayAggregateLiteral).getAnElementExpr(4) or
        elem = gv.getInitializer().getExpr().(ArrayAggregateLiteral).getAnElementExpr(5)) and
      // 定位到SEG6_LOCAL_NH4、SEG6_LOCAL_NH6

      aggr = elem.(ClassAggregateLiteral) and
      aggr.getAFieldExpr(field) = value and
      field.getName() = "len" and
      value instanceof SizeofTypeOperator
      // 判断len字段的值是否为sizeof类型操作符
select gv, elem, field.getName(), value